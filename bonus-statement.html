<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <title>–í—ñ–¥–æ–º—ñ—Å—Ç—å –ø–æ –±–æ–Ω—É—Å—É</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    body{
      margin:0;
      padding:16px;
      font-family:-apple-system, Segoe UI, Roboto, Arial;
      background:#f6f7f9;
    }
    .box{ max-width:520px; margin:0 auto; }

    .card{
      border: 2px solid rgba(42, 171, 238, 0.35);
      border-radius: 16px;
      padding: 14px;
      background: #fff;
      box-shadow: 0 10px 24px rgba(0,0,0,0.08);
    }

    .title{
      text-align:center;
      font-size:22px;
      font-weight:800;
      margin: 4px 0 14px;
    }

    .row{
      display:flex;
      gap:10px;
      align-items:flex-end;
      flex-wrap:wrap;
      margin-bottom: 12px;
    }

    .field{ flex:1 1 140px; }
    .field-label{
      font-size:14px;
      font-weight:700;
      margin-bottom:6px;
      opacity:.85;
    }

    select{
      width:100%;
      height:44px;
      font-size:18px;
      border-radius:12px;
      border:2px solid rgba(42,171,238,.6);
      padding:0 10px;
      box-sizing:border-box;
      background:#fff;
    }

    button{
      width:100%;
      height:50px;
      margin-top:4px;
      font-size:20px;
      border:0;
      border-radius:14px;
      background:#2aabee;
      color:#fff;
      font-weight:800;
      cursor:pointer;
    }
    button:disabled{ opacity:.7; cursor:not-allowed; }

    /* === spinner under button === */
    .calc-spinner{
      display:none;
      margin:14px auto 0;
      width:28px;
      height:28px;
      border-radius:50%;
      border:4px solid rgba(42,171,238,.25);
      border-top-color:#2aabee;
      animation:spin .8s linear infinite;
    }
    @keyframes spin{ to{ transform:rotate(360deg); } }

    .summary{
      margin-top:14px;
      padding:10px 12px;
      border-radius:12px;
      background:rgba(42,171,238,.08);
      border:1px solid rgba(42,171,238,.25);
      font-size:16px;
    }
    .summary b{ font-weight:900; }

    table{
      width:100%;
      margin-top:12px;
      border-collapse:separate;
      border-spacing:0;
      border-radius:14px;
      overflow:hidden;
      border:1px solid rgba(0,0,0,.08);
    }

    thead th{
      background:#f2f6fb;
      font-size:13px;
      text-align:left;
      padding:10px;
      border-bottom:1px solid rgba(0,0,0,.08);
    }

    tbody td{
      font-size:14px;
      padding:10px;
      border-bottom:1px solid rgba(0,0,0,.06);
      background:#fff;
      vertical-align:top;
    }
    tbody tr:last-child td{ border-bottom:0; }

    .money{ font-weight:800; white-space:nowrap; }

    a{ color:#2aabee; text-decoration:none; }

    .hidden{ display:none; }

    .error{
      margin-top:12px;
      padding:10px 12px;
      border-radius:12px;
      background:rgba(229,57,53,.08);
      border:1px solid rgba(229,57,53,.25);
    }

    .table-wrap{
  width:100%;
  overflow-x:auto;
  -webkit-overflow-scrolling: touch;
  border-radius:14px;
}
/* —á—Ç–æ–±—ã —Ç–∞–±–ª–∏—Ü–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Å—á–∏—Ç–∞–ª–∞—Å—å –≤–Ω—É—Ç—Ä–∏ —Å–∫—Ä–æ–ª–ª–∞ */
.table-wrap table{
  min-width: 520px; /* –º–æ–∂–Ω–æ 480/520/560 ‚Äî –ø–æ –≤–∫—É—Å—É */
}

    .error-title{ color:#e53935; font-weight:900; }
  </style>
</head>

<body>
  <div class="box">
    <div class="card">

      <!-- –í–µ—Ä—Ö –∑–∞–≤–∂–¥–∏ –≤–∏–¥–∏–º–∏–π -->
      <div class="title">–í—ñ–¥–æ–º—ñ—Å—Ç—å –ø–æ –Ω–∞—Ä–∞—Ö–æ–≤–∞–Ω–æ–º—É –±–æ–Ω—É—Å—É</div>

      <div class="row">
        <div class="field">
          <div class="field-label">–†—ñ–∫</div>
          <select id="yearSel"></select>
        </div>
        <div class="field">
          <div class="field-label">–ú—ñ—Å—è—Ü—å</div>
          <select id="monthSel"></select>
        </div>
      </div>

      <button id="calcBtn">üßÆ –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
      <div id="calcSpinner" class="calc-spinner"></div>

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
      <div id="resultBlock" class="hidden">
        <div id="summary" class="summary"></div>
  <div class="table-wrap">
  <table>
          <thead>
            <tr>
              <th>–Ü–º º—è</th>
              <th>–°—É–º–∞</th>
              <th>–õ–æ–≥—ñ–Ω –¢–ì</th>
              <th>–í—ñ–¥–ø—Ä–∞—Ü—å–æ–≤–∞–Ω—ñ –¥–Ω—ñ</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
  </table>
</div>
      </div>

      <!-- –ü–æ–º–∏–ª–∫–∞ -->
      <div id="errorBlock" class="hidden error">
        <div class="error-title">‚ùå –ü–æ–º–∏–ª–∫–∞</div>
      </div>

    </div>
  </div>

<script>
  const yearSel = document.getElementById("yearSel");
  const monthSel = document.getElementById("monthSel");
  const calcBtn = document.getElementById("calcBtn");
  const spinner = document.getElementById("calcSpinner");


  const resultBlock = document.getElementById("resultBlock");
  const errorBlock = document.getElementById("errorBlock");
  const summaryEl = document.getElementById("summary");
  const tbodyEl = document.getElementById("tbody");

  const MONTHS = ["—Å—ñ—á–µ–Ω—å","–ª—é—Ç–∏–π","–±–µ—Ä–µ–∑–µ–Ω—å","–∫–≤—ñ—Ç–µ–Ω—å","—Ç—Ä–∞–≤–µ–Ω—å","—á–µ—Ä–≤–µ–Ω—å",
                  "–ª–∏–ø–µ–Ω—å","—Å–µ—Ä–ø–µ–Ω—å","–≤–µ—Ä–µ—Å–µ–Ω—å","–∂–æ–≤—Ç–µ–Ω—å","–ª–∏—Å—Ç–æ–ø–∞–¥","–≥—Ä—É–¥–µ–Ω—å"];

  // init period
  (() => {
    const d = new Date();
    for(let y=d.getFullYear()-2;y<=d.getFullYear()+1;y++){
      yearSel.add(new Option(y,y,y===d.getFullYear()));
    }
    MONTHS.forEach((m,i)=>monthSel.add(new Option(m,i+1,i===d.getMonth())));
  })();

  function fakeHttp(year,month){
    return new Promise(res=>setTimeout(()=>res({
      ok:true,
      total:45012,
      rows:[
        {name:"–Ü–≤–∞–Ω–æ–≤–≤—Ñ—ñ–≤—Ñ—ñ —ñ–≤–∞–Ω–µ–Ω–∫–æ",tg:"t.me/ddd",sum:455,days:["14(–í—Ç)","20(–°—Ä)","25(–°—Ä)","25(–°—Ä)","25(–°—Ä)","25(–°—Ä)","25(–°—Ä)","25(–°—Ä)"]},
        {name:"–ü–µ—Ç—Ä–æ–≤",tg:"t.me/ddd1",sum:455,days:["10(–í—Ç)","21(–°—Ä)","30(–°—Ä)"]}
      ]
    }),900));
  }

  function money(v){return v.toLocaleString("uk-UA")+" –≥—Ä–Ω";}

  async function calculate(){
    calcBtn.disabled=true;
    spinner.style.display="block";
    resultBlock.classList.add("hidden");
    errorBlock.classList.add("hidden");

    try{
      const y=+yearSel.value, m=+monthSel.value;
      const r=await fakeHttp(y,m);
      summaryEl.innerHTML=`<b>–í—Å—å–æ–≥–æ –∑–∞ ${MONTHS[m-1]} ${y} —Ä.</b> <span class="money">${money(r.total)}</span>`;
      tbodyEl.innerHTML=r.rows.map(x=>`
        <tr>
          <td>${x.name}</td>
            <td class="money">${money(x.sum)}</td>          
          <td><a href="https://${x.tg}" target="_blank">${x.tg}</a></td>
          <td>${x.days.join(", ")}</td>
        </tr>`).join("");
      resultBlock.classList.remove("hidden");
    }catch{
      errorBlock.classList.remove("hidden");
    }finally{
      spinner.style.display="none";
      calcBtn.disabled=false;
    }
  }

  calcBtn.onclick=calculate;
</script>
</body>
</html>
